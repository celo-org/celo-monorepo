#!/usr/bin/env bash
set -euo pipefail


EpochSizeAddress=0x00000000000000000000000000000000000000f8


# TODO get bytecode on the fly
#EpochSizeBytecode=0x6080604052600436106100295760003560e01c806338cc483114610096578063572d356e146100b7575b6000366060610065604051806040016040528060168152602001752432b6363790333937b690383932b1b7b6b834b6329960511b8152506100db565b60005460405160200161007a91815260200190565b6040516020818303038152906040529050915050805190602001f35b3480156100a257600080fd5b5060405160f881526020015b60405180910390f35b3480156100c357600080fd5b506100cd60005481565b6040519081526020016100ae565b61011e816040516024016100ef9190610142565b60408051601f198184030181529190526020810180516001600160e01b031663104c13eb60e21b179052610121565b50565b80516a636f6e736f6c652e6c6f67602083016000808483855afa5050505050565b600060208083528351808285015260005b8181101561016f57858101830151858201604001528201610153565b506000604082860101526040601f19601f830116850101925050509291505056fea2646970667358221220e7827445ea2b04013d1360e8cde20b4f4a2893e7b231999eefa108789c3f4a3264736f6c63430008130033
EpochSizeBytecode=`cat ./out/EpochSizePrecompile.sol/EpochSizePrecompile.json | jq -r '.deployedBytecode.object'`

cast rpc anvil_setCode --rpc-url http://127.0.0.1:8545 $EpochSizeAddress $EpochSizeBytecode